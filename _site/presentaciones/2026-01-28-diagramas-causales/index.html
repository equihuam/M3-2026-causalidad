<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Miguel Equihua">

<title>Introducción a Diagramas Causales – Curso de Estadística (Inecol 2026)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/causalidad-2026.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e41caad1b6b9b62eb3087831f3b4c651.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-e41caad1b6b9b62eb3087831f3b4c651.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e41caad1b6b9b62eb3087831f3b4c651.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-2fb77ccd341c7b5dc4ea2940181b5c0e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-9f9210b263e96d54cf2af0ff29f9e6a3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-2fb77ccd341c7b5dc4ea2940181b5c0e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No se han encontrado resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Curso de Estadística (Inecol 2026)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-algo-más" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Algo más</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-algo-más">    
        <li>
    <a class="dropdown-item" href="../../about.html">
 <span class="dropdown-text">Acerca de</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../presentaciones.html">
 <span class="dropdown-text">M3-Presentaciones</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ejercicios.html">
 <span class="dropdown-text">M3-ejercicios</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/equihuam/M3-2026_causalidad"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="index.html"><i class="bi bi-file-slides"></i>RevealJS (metropolis)</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introducción a Diagramas Causales</h1>
  <div class="quarto-categories">
    <div class="quarto-category">presentación</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Miguel Equihua <a href="mailto:miguel.equihua@ecologia.edu.mx" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Xalapa, Ver., 28 enero 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="la-escalera-de-la-causalidad" class="level2">
<h2 class="anchored" data-anchor-id="la-escalera-de-la-causalidad">La escalera de la causalidad</h2>
<div class="quarto-layout-panel" data-layout="[[1, 1], [1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/Clase_2 - Diagramas Causales2.png" class="img-fluid" width="420"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/Clase_2 - Diagramas Causales3.png" class="img-fluid" width="178"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p><span style="font-size:60%;">Pearl, Judea. The Book of Why: The New Science of Cause and Effect (p.&nbsp;28). Basic Books.</span></p>
</div>
</div>
</div>
</section>
<section id="diagrama-causal" class="level1">
<h1>Diagrama Causal</h1>
<div class="columns">
<div class="column" style="width:&quot;50%;">
<div class="smaller">
<ul>
<li><p>Es un diagrama o <em>grafo</em> que describe una proposición causal para un conjunto de variables.</p></li>
<li><p>Las Herramientas matemáticas y estadísticas para operarlos han sido impulsadas por Judea Pearl y sus colegas desde los 1980.</p></li>
<li><p>Particularmente interesan los grafos acíclicos dirigidos, de ahí <em>DAG</em> .</p></li>
</ul>
</div>
</div><div class="column" style="width:&quot;50%;">
<p><img src="images/causal-diagram.svg" class="img-fluid"></p>
</div>
</div>
<div style="font-size:60%;">
<p><a href="https://academic.oup.com/biomet/article-abstract/82/4/669/251647?redirectedFrom=fulltext"><strong>Pearl, J. (1995). Causal Diagrams for Empirical Research.</strong> <em>Biometrika</em> <strong>,</strong> <em>82</em> <strong>(4), 669–688. https://doi.org/10.2307/2337329</strong></a></p>
</div>
<section id="terminología-básica-de-un-dag" class="level2">
<h2 class="anchored" data-anchor-id="terminología-básica-de-un-dag">Terminología básica de un DAG</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size:80%">
<ul>
<li><strong>Nodo</strong> : una variable</li>
<li><strong>Arista</strong> : una relación causal, representada por una flecha</li>
<li><strong>Variable Explicativa</strong> : Es nuestro predictor causal de interés. Aquí es la representada por <em>X</em> . También se le llama variable independiente.</li>
<li><strong>Respuesta</strong> : En el <em>DAG</em> es la representada por <em>Y</em> . También se le llama variable dependiente.</li>
<li><strong>Ancestros</strong> : Nodos que están “aguas arriba” de una variable dada. En este <em>DAG</em> <em>A</em> y <em>C</em> son ancestros de <em>X</em> .</li>
<li><strong>Descendientes</strong> : Nodos que están “aguas abajo” de una variable en particular. En este <em>DAG</em> <em>Y</em> y <em>B</em> son descendientes de <em>X</em> .</li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<p><img src="images/elementos-de-un-dag.svg" class="img-fluid" width="500"></p>
</div>
</div>
</section>
<section id="b-es-una-variable-mediadora-del-efecto-de-a" class="level2">
<h2 class="anchored" data-anchor-id="b-es-una-variable-mediadora-del-efecto-de-a">B es una variable “mediadora” del efecto de A</h2>
<div class="quarto-layout-panel" data-layout="[[-1], [1], [-1]]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="images/variable-mediadora.svg" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="papel-de-las-variables-en-un-dag" class="level2">
<h2 class="anchored" data-anchor-id="papel-de-las-variables-en-un-dag">Papel de las variables en un DAG</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size:60%;">
<ul>
<li><strong>Factor de Confusión</strong> : Es ancestro tanto de la explicativa <em>X</em> como de la respuesta <em>Y</em> . <em>A</em> lo es el <em>DAG</em> .</li>
<li><strong>Mediador</strong> : Es al mismo tiempo descendiente de la explicativa y ancestro de la respuesta. <em>F</em> lo es. Parte (o la totalidad) del efecto causal sobre la respuesta se transmite a través de él.</li>
<li><strong>Proxy de un</strong> <strong>Factor de</strong> <strong>Confusión</strong> : Es descendiente de un factor de confusión y ancestro de la explicativa o de la respuesta (pero no de ambas, pues entonces sería un factor de confusión). El efecto de confusión se transmite a través de esta variable. <em>B</em> es proxy.</li>
<li><strong>Competidor de la explicativa</strong> : Es un ancestro de la variable de respuesta <em>Y,</em> sin ser ni ancestro ni descendiente de la exposición <em>X</em> . <em>G</em> compite aquí.</li>
<li><strong>Instrumento</strong> : Un instrumento es un ancestro de la explicativa. No tiene ningún camino hacia la respuesta <em>Y</em> que no pase a través de la explicativa <em>X</em> (pues sería un factor de confusión). <em>D</em> es un instrumento.</li>
<li><strong>Colisionador</strong> : Un colisionador es un descendiente tanto de la exposición X como de la respuesta Y. E es un colisionador en el ejemplo DAG.</li>
</ul>
</div>
</div><div class="column" style="width:&quot;35%;">
<p><img src="images/tipos-relacion-dag.svg" class="img-fluid" width="500"></p>
</div>
</div>
</section>
<section id="cuándo-esperar-asociación" class="level2">
<h2 class="anchored" data-anchor-id="cuándo-esperar-asociación">Cuándo esperar asociación</h2>
<div class="quarto-layout-panel" data-layout="[[1], [-1, 1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="images/esperar asociación.svg" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>… a veces por pura buen fortuna</strong></p>
</div>
</div>
</div>
</section>
<section id="sesgo-sistemático-efecto-de-confusión" class="level2">
<h2 class="anchored" data-anchor-id="sesgo-sistemático-efecto-de-confusión">Sesgo sistemático: efecto de confusión</h2>
<div class="quarto-layout-panel" data-layout="[[1], [-1, 2]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="images/sesgo-sistematico.svg" class="img-fluid"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 66.7%;justify-content: flex-start;">
<p><span style="color:#0074B5; font-size:60%;">Hay sesgo sistemático si hay una asociación entre A e Y que no surge del efecto causal de A sobre Y. Cuando existe una asociación entre A e Y, incluso si A tiene un efecto causal cero sobre Y, se dice que hay sesgo bajo la condición nula.</span></p>
</div>
</div>
</div>
</section>
<section id="sesgo-por-selección" class="level2">
<h2 class="anchored" data-anchor-id="sesgo-por-selección">Sesgo por Selección</h2>
<div class="quarto-layout-panel" data-layout="[[-1], [1], [-1]]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="images/sesgo-seleccion.svg" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="en-un-dag-con-nodos-l-a-e-y-en-este-orden-de-aparición" class="level2">
<h2 class="anchored" data-anchor-id="en-un-dag-con-nodos-l-a-e-y-en-este-orden-de-aparición">En un DAG con nodos L, A e Y (en este orden de aparición)</h2>
<p>¿Qué significa que no haya un arco del nodo A al Y?</p>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div style="height:80vh;">
  <iframe width="100%" height="100%" src="https://vevox.app/#/m/169614732?integration=embed" style="min-height: 80vh;" frameborder="0" title="participación Vevox">
    </iframe>
</div>
</section>
<section id="si-nuestro-conocimiento-en-la-materia-es-insuficiente-para-descartar-la-existencia-de-un-efecto-directo-de-la-variable-d-sobre-la-e." class="level2">
<h2 class="anchored" data-anchor-id="si-nuestro-conocimiento-en-la-materia-es-insuficiente-para-descartar-la-existencia-de-un-efecto-directo-de-la-variable-d-sobre-la-e.">Si nuestro conocimiento en la materia es insuficiente para descartar la existencia de un efecto directo de la variable D sobre la E.</h2>
<p>¿Deberíamos incluir un arco de D a E en el diagrama causal?</p>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div style="height:80vh;">
  <iframe width="100%" height="100%" src="https://vevox.app/#/m/169614732?integration=embed" style="min-height: 80vh;" frameborder="0" title="participación Vevox">
    </iframe>
</div>
</section>
<section id="la-inteligencia-reduce-el-tiempo-necesario-de-estudio-para-aprender.-al-mismo-tiempo-la-inteligencia-junto-con-el-tiempo-de-estudio-explican-la-calificación-en-el-examen.-cuál-es-el-dag-que-describe-esta-proposición-causal" class="level2">
<h2 class="anchored" data-anchor-id="la-inteligencia-reduce-el-tiempo-necesario-de-estudio-para-aprender.-al-mismo-tiempo-la-inteligencia-junto-con-el-tiempo-de-estudio-explican-la-calificación-en-el-examen.-cuál-es-el-dag-que-describe-esta-proposición-causal">La inteligencia reduce el tiempo necesario de estudio para aprender. Al mismo tiempo, la inteligencia, junto con el tiempo de estudio explican la calificación en el examen. ¿Cuál es el DAG que describe esta proposición causal?</h2>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<div style="height:80vh;">
  <iframe width="100%" height="100%" src="https://vevox.app/#/m/169614732?integration=embed" style="min-height: 80vh;" frameborder="0" title="participación Vevox">
    </iframe>
</div>
</section>
<section id="reglas-de-independencia-condicional" class="level2">
<h2 class="anchored" data-anchor-id="reglas-de-independencia-condicional">Reglas de independencia condicional</h2>
<p>Un <em>DAG</em> también describe aspectos clave del “flujo de la asociación” a través de la estructura causal.</p>
<ul>
<li><p>Cuando las variables están conectadas, correlacionan, lo que implica que la información puede fluir entre ellas en cualquier dirección.</p></li>
<li><p>Hay tres reglas fundamentales sobre como se puede dar esta interconexión, es decir de como se <strong>separan</strong> o <strong>conectan</strong> los nodos.</p></li>
</ul>
</section>
<section id="regla-1-variable-intermedia" class="level2">
<h2 class="anchored" data-anchor-id="regla-1-variable-intermedia">Regla 1 “variable intermedia”</h2>
<div class="quarto-layout-panel" data-layout="[[1], [-1], [1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Dos variables, X e Y, son condicionalmente independientes dado <em>A</em> , si sólo hay una ruta unidireccional entre <em>X</em> e <em>Y</em> , cuando <em>A</em> es una variable (podrían ser muchas) intercalada en el camino.</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><img src="images/variable-intermedia.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="regla-2-causa-común" class="level2">
<h2 class="anchored" data-anchor-id="regla-2-causa-común">Regla 2 “causa común”</h2>
<div class="quarto-layout-panel" data-layout="[[-1], [1, 1]]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Si una variable <em>A</em> es una causa común de las variables <em>X</em> e <em>Y</em> , y solo hay una ruta entre <em>X</em> e <em>Y</em> , entonces <em>X</em> e <em>Y</em> son condicionalmente independientes cuando se consideran como condicionantes los datos de <em>A</em> .</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/variale-causa-comun.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="regla-3-colisionador" class="level2">
<h2 class="anchored" data-anchor-id="regla-3-colisionador">Regla 3 “colisionador”</h2>
<div class="quarto-layout-panel" data-layout="[[-1], [1, 1]]">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Si una variable <em>A</em> es el nodo de colisión entre dos variables <em>X</em> e <em>Y</em> , y solo hay un camino entre <em>X</em> e <em>Y</em> , entonces <em>X</em> e <em>Y</em> son incondicionalmente independientes pero dependen condicionalmente de <em>A</em> así como de cualquier descendiente de <em>A</em> .</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/variale-colisionador.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="separación-direccional-d-separation" class="level2">
<h2 class="anchored" data-anchor-id="separación-direccional-d-separation">Separación-direccional (d-separation)</h2>
<p>El flujo de información en una ruta <em>p</em> queda bloqueado por un conjunto de nodos <em>Z</em> si y sólo si:</p>
<ol type="1">
<li><p><em>p</em> contiene una cadena de nodos <em>A</em> → <em>B</em> → <em>C</em> o una horquilla <em>A</em> ← <em>B</em> → <em>C</em> , de tal manera que el nodo medio <em>B</em> proporciona datos como criterio condicional de observación. Es decir si la ruta es del tipo <strong>variable intermedia o causa común, el condicionarlas bloquea.</strong></p></li>
<li><p><em>p</em> contiene un colisionador <em>A</em> → <em>B</em> ← <em>C</em> tal que ni el nodo de colisión <em>B</em> , ni ninguno de sus descendientes, son criterio para condicionar las observaciones. Es decir <strong>condicionar sore un colisionador desbloquea</strong> .</p></li>
</ol>
</section>
</section>
<section id="regla-de-la-puerta-trasera" class="level1">
<h1>Regla de la Puerta trasera</h1>
<div class="quarto-layout-panel" data-layout="[[1, 1], [-1, 1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li><p><strong>Podemos identificar el efecto causal de</strong> <em>A</em> e <em>Y</em> si tenemos datos suficientes como para <strong>bloquear todas las rutas de puerta trasera</strong> entre <em>A</em> e <em>Y</em>.</p></li>
<li><p>En este caso se trata de condicionar <em>L.</em></p></li>
</ul>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/regla-puerta-trasera.svg" class="img-fluid"></p>
</div>
</div>
</div>
<section id="se-puede-medir-el-efecto-sin-sesgos-de-la-aspirina" class="level2">
<h2 class="anchored" data-anchor-id="se-puede-medir-el-efecto-sin-sesgos-de-la-aspirina">¿Se puede medir el efecto, sin sesgos, de la aspirina?</h2>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<div style="height:80vh;">
  <iframe width="100%" height="100%" src="https://vevox.app/#/m/169614732?integration=embed" style="min-height: 800px;" frameborder="0" title="participación Vevox">
    </iframe>
</div>
</section>
<section id="colisionadores" class="level2">
<h2 class="anchored" data-anchor-id="colisionadores">Colisionadores</h2>
<ul>
<li>McElreath nos ofrece esta proposición:
<ul>
<li>Los estudios científicos más <em>noticiables</em> son los menos fiables. Cuanto más probable es que te mate, si es cierto, menos probable es que sea cierto. Cuanto más aburrido el tema, más rigurosos los resultados.</li>
</ul></li>
</ul>
<p><a href="https://bookdown.org/content/4857/the-haunted-dag-the-causal-terror.html" style="font-size:60%">Fuente: <em>The Haunted DAG &amp; The Causal Terror | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition (bookdown.org)</em></a></p>
</section>
<section id="cómo-se-produce-esta-correlación-negativa" class="level2">
<h2 class="anchored" data-anchor-id="cómo-se-produce-esta-correlación-negativa">¿Cómo se produce esta correlación negativa?</h2>
<p>Esta asociación NO CAUSAL se produce cuando los revisores se preocupan tanto por el interés “innovador” (pensando en su potencial noticioso), como por la fiabilidad.</p>
<p>Una fuerte selección induce una correlación negativa entre los criterios utilizados en la selección.</p>
<p>¿Por qué? Si la única forma de cruzar el umbral es obtener una puntuación alta, es más frecuente obtener una puntuación alta en un criterio que en ambos.</p>
<p><a href="https://bookdown.org/content/4857/the-haunted-dag-the-causal-terror.html" style="font-size:60%">Fuente: <em>The Haunted DAG &amp; The Causal Terror | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition (bookdown.org)</em></a></p>
</section>
<section id="la-paradoja-de-simpson" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="la-paradoja-de-simpson">La paradoja de Simpson</h2>
<p>Ejemplo con datos de COVID-19 sobre mortalidad por raza, tal y como se describe en el <a href="http://causality.cs.ucla.edu/blog/index.php/2020/07/06/race-covid-mortality-and-simpsons-paradox-by-dana-mackenzie/"><em>blog de Judea Pearl</em></a> .</p>
<p>La paradoja: los blancos no hispanos tienen una mayor mortalidad si nos fijamos en los datos agregados. Pero: Desagregados por edad (relativo a la expectativa de vida, de ahí el arco B), los blancos tienen una mortalidad menor en todos los grupos de edad. El DAG correspondiente:</p>
<p>. . .</p>
<div class="quarto-layout-panel" data-layout="[[1, 1], [-1, 1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/Clase_2 - Diagramas Causales9.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Como podemos ver en el gráfico, la edad es un factor de confusión para esta relación y, por tanto, mirar los datos observacionales <em>Pr</em> (Muerte|Raza) no dará la respuesta correcta. Una vez que observamos <em>Pr</em> (Muerte|Raza, Edad), el efecto de la variable Raza se invierte. La razón por la que puede ocurrir esto es poco intuitiva.</p>
</div>
</div>
</div>
</section>
<section id="la-paradoja-de-berkson" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="la-paradoja-de-berkson">La paradoja de Berkson</h2>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>La paradoja de Berkson surge al condicionar un colisionador. Esto puede parecer paradójico pero usualmente es un artefacto del diseño del estudio, por ejemplo durante la selección de participantes.</li>
<li>Supongamos investigas si existe alguna relación entre contraer COVID y padecer alguna otra enfermedad.</li>
<li>Supongamos además que en la población general la COVID es independiente de otras enfermedades. Ahora bien, si basas tu estudio únicamente en pacientes hospitalizados, encontrarás que Pr(COVID|no Otras enfermedades) = ¡1!</li>
<li>Obviamente hubo algún padecimiento para estar hospitalizados.</li>
<li>Condicionar a la hospitalización hace que las dos variables resulten asociadas, cuando antes no lo eran.</li>
<li><strong>El condicionamiento sobre el colisionador ha desbloqueado la vía causal entre las dos variables.</strong></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img src="images/covid-comorbilidades.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="efecto-problemático-de-un-colisionador" class="level2">
<h2 class="anchored" data-anchor-id="efecto-problemático-de-un-colisionador">Efecto problemático de un “colisionador”</h2>
<div class="quarto-layout-panel" data-layout="[[2], [-1, 1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p><img src="images/colisionador.png" class="img-fluid"> <a href="https://www.nature.com/articles/s41467-020-19478-2" style="font-size:60%">Fuente: <em>https://www.nature.com/articles/s41467-020-19478-2</em></a></p>
</div>
</div>
</div>
</section>
<section id="cómo-influye-la-edad-sobre-la-felicidad" class="level2">
<h2 class="anchored" data-anchor-id="cómo-influye-la-edad-sobre-la-felicidad">¿cómo influye la edad sobre la felicidad?</h2>
<p>Si disponemos de una amplia encuesta de personas felices, ¿cabría esperar alguna asociación entre la edad y la felicidad?</p>
</section>
</section>
<section id="estrellas-de-cine" class="level1">
<h1>Estrellas de cine</h1>
<ul>
<li>Supongamos que para convertirse en una estrella de cine de éxito hay que tener un talento especial o ser especialmente guapo, pero usualmente no ambos.</li>
<li>Supongamos también razonablemente, que en el conjunto de la población no existe correlación entre talento y aspecto.</li>
<li>Si condicionamos un estudio a analizar solamente estrellas de cine, muy probablemente creamos una confusa correlación negativa entre talento y aspecto.</li>
</ul>
</section>
<section id="estrellas-de-la-ciencia" class="level1">
<h1>Estrellas de la ciencia</h1>
<p>Si condicionamos a estar en una institución de élite, crearemos una correlación negativa NO CAUSAL entre el talento y el trabajo duro.</p>
<section id="la-paradoja-del-bajo-peso-al-nacer" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="la-paradoja-del-bajo-peso-al-nacer">La paradoja del bajo peso al nacer</h2>
<p>Este es un ejemplo real que desconcertó a la comunidad médica durante muchos años.</p>
<p>Al estudiar el efecto del tabaco en la mortalidad infantil. Ya se sabía que fumar provocaba un mayor riesgo de bajo peso al nacer y que el bajo peso al nacer aumenta el riesgo de mortalidad infantil.</p>
<p>¿El tabaquismo tiene algún otro efecto sobre la mortalidad infantil?, aparte de causar bajo peso al nacer.</p>
<p>La intuición de los investigadores sugirió condicionar el peso al nacer y entonces observar el efecto del tabaquismo sobre la mortalidad: ¡se descubrió que fumar tenía un efecto protector!</p>
<p>La explicación es que ¡se trata de un sesgo del colisionador!</p>
<p>Hay varias causas de bajo peso al nacer. Fumar es una de ellas, pero hay otras.</p>
<p>Las otras causas de bajo peso al nacer tienen un mayor riesgo negativo sobre la mortalidad infantil, aparte de su efecto sobre el bajo peso al nacer.</p>
<p>Como reto, dibuja el DAG correspondiente y combina todos estos hechos para averiguar cómo el condicionamiento sobre el peso al nacer puede crear el hallazgo de que fumar tiene un falso efecto protector.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>